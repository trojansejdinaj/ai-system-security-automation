# Week 03 — Logging Baseline + Correlation IDs

**Date:** 2026-01-19  
**Focus:** Observability foundation — structured logging and execution traceability

---

## Summary

Week 03 establishes a production-grade observability baseline for the **AI System Security Automation** portfolio.

The system now emits **structured JSON logs** with **automatic correlation ID injection**, enabling end-to-end traceability of each execution. Logging behavior is deterministic, reproducible, and validated by tests.

This week deliberately focuses on *infrastructure*, not detection logic.

---

## What Changed

### Code

**New observability package**
- `src/security_automation/observability/__init__.py`
- `src/security_automation/observability/context.py`
  - ContextVar-based correlation ID storage
  - Async- and thread-safe
- `src/security_automation/observability/logging.py`
  - JSONFormatter (one JSON object per log line)
  - Automatic correlation ID injection
  - Environment-driven configuration

**Updated execution flow**
- `src/security_automation/main.py`
  - Logging configured at process start
  - Correlation ID generated (UUID) or read from `CORRELATION_ID`
  - Semantic events emitted across lifecycle:
    - `run_started`
    - `init_tasks`
    - `policy_evaluated`
    - `automation_executed`
    - `run_completed`
  - Correlation ID cleared on exit

**Entrypoint**
- `src/security_automation/__main__.py`
  - Enables `python -m security_automation`

**Packaging**
- Project installed in editable mode (`uv pip install -e .`)
- Python version aligned to **Python 3.12**
- `python -m security_automation` works without PYTHONPATH hacks

**Makefile**
- `make run` — run automation
- `make demo-log` — emit example JSON logs
- `make test` — run test suite

---

### Tests

**New tests**
- `tests/test_logging.py`
  - Validates JSON log output
  - Verifies correlation ID injection
  - Ensures ContextVar isolation between runs
- Entrypoint execution covered (total tests: 5)

**Test status**
- ✅ All tests passing
- ✅ Python 3.12
- ✅ Coverage ~90%

---

### Documentation

**New**
- `docs/architecture/logging.md`
  - Log schema
  - Correlation ID lifecycle
  - Querying examples (`jq`, grep)
- `docs/decisions/0003-logging-and-correlation-ids.md`
  - Design rationale (JSON logs, ContextVar, stdlib logging)

**Updated**
- `README.md`
  - Observability & Logging section
- `docs/architecture/README.md`
  - Linked logging architecture doc

---

## How to Run

### One-time setup
```bash
uv pip install -e .
